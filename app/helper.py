
import HTMLParser
import urllib

def parseResponse(inp):

    splitString = inp.split("&")
    parsedDict = {}

    for i in splitString:

        splitKey =  i.split("=")
# HTMLParser.HTMLParser().unescape('Suzy &amp; John')

        # print splitKey
        decodedValue = urllib.unquote(splitKey[1])
        parsedDict[splitKey[0]] = decodedValue


    return parsedDict

def getFromResponseWithKey(response, key):

    return parseResponse(response)[key]

def getAddressFromResponse(response):

    dict = parseResponse(response)
    
    address = ""

    address += dict['SHIPTONAME'] + ', '
    address += dict['SHIPTOSTREET'] + ', '
    address += dict['SHIPTOCITY'] + ', '
    address += dict['SHIPTOSTATE'] + ', '
    address += dict['SHIPTOZIP'] + ', '
    address += dict['SHIPTOCOUNTRYCODE'] + ', '
    address += dict['SHIPTOCOUNTRYNAME'] + ''

    return address

if __name__ == '__main__':
    # print inp
    # print splitString

    testString = "TOKEN=EC%2d3NP60445HT923692X&BILLINGAGREEMENTACCEPTEDSTATUS=0&CHECKOUTSTATUS=PaymentActionNotInitiated&TIMESTAMP=2015%2d02%2d26T06%3a24%3a50Z&CORRELATIONID=5d43260fc1f26&ACK=Success&VERSION=109%2e0&BUILD=15554367&EMAIL=jiahaog%2dbuyer%40gmail%2ecom&PAYERID=UNG885DPEH7SC&PAYERSTATUS=verified&FIRSTNAME=test&LASTNAME=buyer&COUNTRYCODE=US&SHIPTONAME=test%20buyer&SHIPTOSTREET=1%20Main%20St&SHIPTOCITY=San%20Jose&SHIPTOSTATE=CA&SHIPTOZIP=95131&SHIPTOCOUNTRYCODE=US&SHIPTOCOUNTRYNAME=United%20States&ADDRESSSTATUS=Confirmed&CURRENCYCODE=USD&AMT=105%2e87&ITEMAMT=99%2e30&SHIPPINGAMT=3%2e00&HANDLINGAMT=2%2e99&TAXAMT=2%2e58&INSURANCEAMT=1%2e00&SHIPDISCAMT=%2d3%2e00&L_NAME0=Awesome%20Chocolates&L_NAME1=Bags%20of%20awesome%20sweets&L_NUMBER0=623083&L_NUMBER1=623084&L_QTY0=2&L_QTY1=2&L_TAXAMT0=0%2e00&L_TAXAMT1=0%2e00&L_AMT0=9%2e95&L_AMT1=39%2e70&L_DESC1=Size%3a%20Two%2024%2dpiece%20boxes&L_ITEMWEIGHTVALUE0=%20%20%200%2e00000&L_ITEMWEIGHTVALUE1=%20%20%200%2e00000&L_ITEMLENGTHVALUE0=%20%20%200%2e00000&L_ITEMLENGTHVALUE1=%20%20%200%2e00000&L_ITEMWIDTHVALUE0=%20%20%200%2e00000&L_ITEMWIDTHVALUE1=%20%20%200%2e00000&L_ITEMHEIGHTVALUE0=%20%20%200%2e00000&L_ITEMHEIGHTVALUE1=%20%20%200%2e00000&PAYMENTREQUEST_0_CURRENCYCODE=USD&PAYMENTREQUEST_0_AMT=105%2e87&PAYMENTREQUEST_0_ITEMAMT=99%2e30&PAYMENTREQUEST_0_SHIPPINGAMT=3%2e00&PAYMENTREQUEST_0_HANDLINGAMT=2%2e99&PAYMENTREQUEST_0_TAXAMT=2%2e58&PAYMENTREQUEST_0_INSURANCEAMT=1%2e00&PAYMENTREQUEST_0_SHIPDISCAMT=%2d3%2e00&PAYMENTREQUEST_0_INSURANCEOPTIONOFFERED=false&PAYMENTREQUEST_0_SHIPTONAME=test%20buyer&PAYMENTREQUEST_0_SHIPTOSTREET=1%20Main%20St&PAYMENTREQUEST_0_SHIPTOCITY=San%20Jose&PAYMENTREQUEST_0_SHIPTOSTATE=CA&PAYMENTREQUEST_0_SHIPTOZIP=95131&PAYMENTREQUEST_0_SHIPTOCOUNTRYCODE=US&PAYMENTREQUEST_0_SHIPTOCOUNTRYNAME=United%20States&PAYMENTREQUEST_0_ADDRESSSTATUS=Confirmed&PAYMENTREQUEST_0_ADDRESSNORMALIZATIONSTATUS=None&L_PAYMENTREQUEST_0_NAME0=Awesome%20Chocolates&L_PAYMENTREQUEST_0_NAME1=Bags%20of%20awesome%20sweets&L_PAYMENTREQUEST_0_NUMBER0=623083&L_PAYMENTREQUEST_0_NUMBER1=623084&L_PAYMENTREQUEST_0_QTY0=2&L_PAYMENTREQUEST_0_QTY1=2&L_PAYMENTREQUEST_0_TAXAMT0=0%2e00&L_PAYMENTREQUEST_0_TAXAMT1=0%2e00&L_PAYMENTREQUEST_0_AMT0=9%2e95&L_PAYMENTREQUEST_0_AMT1=39%2e70&L_PAYMENTREQUEST_0_DESC1=Size%3a%20Two%2024%2dpiece%20boxes&L_PAYMENTREQUEST_0_ITEMWEIGHTVALUE0=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMWEIGHTVALUE1=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMLENGTHVALUE0=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMLENGTHVALUE1=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMWIDTHVALUE0=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMWIDTHVALUE1=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMHEIGHTVALUE0=%20%20%200%2e00000&L_PAYMENTREQUEST_0_ITEMHEIGHTVALUE1=%20%20%200%2e00000&PAYMENTREQUESTINFO_0_ERRORCODE=0"


    a = getFromResponseWithKey(testString, "AMT")
    print a
    print getAddressFromResponse(testString)

    
    
